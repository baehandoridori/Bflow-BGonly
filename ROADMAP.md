# ROADMAP.md — BG 진행 현황판 개발 로드맵

> **최종 갱신**: 2026-02-20 (Phase 2 완료)
> **프로젝트**: Bflow-BGonly (Studio JBBJ BG 진행 현황 대시보드)
> **담당**: Claude × 한솔 (Studio JBBJ)

---

## 범례

| 표기 | 의미 |
|------|------|
| `[완료]` | 구현 완료, 운영 중 |
| `[진행]` | 현재 구현 중 |
| `[ ]` | 미착수 |
| `P1` ~ `P5` | 개발 페이즈 (우선순위순) |
| `난이도: ●○○` | 낮음 / `●●○` 중간 / `●●●` 높음 |

---

## Phase 1: 핵심 씬 관리 강화 `[완료]`

> **목표**: 현재 씬 목록 뷰의 가시성과 조작성을 프로덕션 수준으로 끌어올린다.
> **영향도**: 매일 쓰는 핵심 워크플로우 직접 개선. 체감 효과 즉시.
> **완료일**: 2026-02-19

### 1-1. 씬 목록 정렬 및 가시성 개선 `P1` `[완료]`

> 난이도: ●●○ | 참고: ftrack 멀티레벨 그룹핑, Kitsu 상태 매트릭스

- [x] **정렬 옵션 드롭다운**: 씬번호순 (기본), 담당자순, 진행률순, 미완료 우선
- [x] **정렬 방향 토글**: 오름차순 ↑ / 내림차순 ↓
- [x] **상태 필터 칩**: "미착수", "진행중", "완료" 등 빠른 필터 (담당자 필터와 병렬)
- [x] **컬러 코딩 강화**: 진행률에 따른 카드 좌측 보더 컬러 (0%=빨강, 50%=노랑, 100%=초록)
- [x] **리스트 뷰 / 카드 뷰 토글**: 카드(현재) + 테이블(밀집 정보) 전환

```
UX 참고:
- ftrack: 스프레드시트/썸네일 레이아웃 토글 + 멀티레벨 그룹핑 툴바
- Kitsu: 씬(행) × 단계(열) 컬러 매트릭스 — 가장 정보밀도 높은 뷰
- ShotGrid: 리스트/썸네일/디테일 3단 토글
```

### 1-2. 레이아웃별 씬 그룹핑 `P1` `[완료]`

> 난이도: ●●● | 핵심 기능 — BG 작업은 레이아웃 단위로 진행되므로 필수

- [x] **레이아웃 번호 필드 추가**: Scene 타입에 `layoutId: string` 필드 추가
  - 카드에서 클릭하여 편집 가능, 테이블 뷰에도 컬럼 추가
- [x] **레이아웃별 뷰**:
  - 레이아웃 번호로 그룹핑 → 각 그룹 안에 해당 씬 카드/테이블 나열
  - 레이아웃 헤더에 해당 그룹 진행률 표시
  - 예: `레이아웃 #1 — a001, a004 (진행률 75%)`
- [x] **씬번호별 뷰**: 기존 씬번호 순서대로 플랫하게 나열 (현재 방식)
- [x] **뷰 전환 토글**: 상단 바에 `씬번호별` / `레이아웃별` 아이콘 토글

```
데이터 구조 변경:
  Scene {
    ...existing,
    layoutId: string;  // 쉼표 구분: "a001, a008, a009"
  }

파싱 로직:
  layoutId.split(',').map(s => s.trim()).filter(Boolean)
  → ['a001', 'a008', 'a009'] 각각 클릭 가능한 태그
```

### 1-3. 씬번호 입력 개선 `P1` `[완료]`

> 난이도: ●●○ | 참고: 드롭다운 기반 입력으로 오타 방지

- [x] **접두사 드롭다운**: `a` / `b` / `c` / `d` / `sc` 등 알파벳 프리픽스 선택
- [x] **자동 번호 제안**: 선택된 프리픽스의 기존 번호 중 빈 번호를 자동 입력
  - 예: a001, a002, a004 존재 시 → 다음 제안값 `a003`
- [x] **수동 번호 입력**: 드롭다운 옆 숫자 입력 필드 (제안값이 기본 채워짐)
- [x] **중복 검사**: 이미 존재하는 씬번호 입력 시 경고 + 추가 버튼 비활성화
- [x] **연속 입력 지원**: 추가 후 폼 유지, 다음 번호 자동 채움, Enter/Esc 키보드 지원

### 1-4. 버전 표기 시스템 `P1` `[완료]`

> 난이도: ●○○ | 빠른 구현 가능

- [x] **package.json 버전 활용**: `version` 필드를 `__APP_VERSION__`으로 Vite define
- [x] **사이드바 하단 표기**: `[TEST]` 모드 표시 아래에 `v0.1.0` 표기
- [ ] **업데이트 시 자동 증가**: 빌드/배포 시 버전 태그 갱신
- [ ] **변경 내역 표시**: 설정 뷰에서 최근 업데이트 내역 확인 가능

```
표시 위치:
  사이드바 하단
  ┌─────────────┐
  │  ...메뉴...   │
  │              │
  │  [TEST]      │
  │  v1.2.0      │
  └─────────────┘
```

---

## Phase 2: 이미지 확인 및 리뷰 시스템 `[완료]`

> **목표**: BG 작업 특성상 이미지 확인이 필수. 씬 카드에서 바로 이미지를 보고 비교할 수 있게.
> **영향도**: BG 아티스트와 감독의 리뷰 워크플로우 혁신.
> **완료일**: 2026-02-20

### 2-1. 씬 이미지 업로드 및 미리보기 `P2` `[완료]`

> 난이도: ●●● | 참고: Kitsu 클립보드 붙여넣기, ftrack 드래그&드롭

- [x] **이미지 타입 2종**: 스토리보드 이미지 + 가이드(예시) 이미지
- [x] **업로드 방식 3종**:
  - 클립보드 붙여넣기 (`Ctrl+V`) — 카드에 포커스 후 붙여넣기
  - 드래그 & 드롭 — 파일을 카드 위에 드래그 (파란색 오버레이)
  - 파일 선택 다이얼로그 — SB/가이드 버튼 클릭
- [x] **씬 카드 썸네일**: 작은 미리보기 표시 (스토리보드/가이드 나란히)
- [x] **확대 보기**: 클릭 시 모달로 원본 크기 이미지 표시
- [x] **이미지 저장 전략**:
  - 로컬 저장: `%APPDATA%/Bflow-BGonly/images/{sheetName}/` 디렉토리
  - `local-image://` 커스텀 프로토콜로 렌더러에서 표시
  - 파일 경로를 `storyboardUrl`/`guideUrl` 필드에 저장

### 2-2. 이미지 비교 뷰 `P2` `[완료]`

> 난이도: ●●○ | 참고: ftrack 오버레이 비교, Kitsu 사이드바이사이드

- [x] **사이드 바이 사이드**: 스토리보드 vs 가이드 이미지 병렬 표시
- [x] **오버레이 비교**: 두 이미지를 겹쳐 놓고 불투명도 슬라이더로 전환
- [x] **확대/축소**: 줌 인/아웃 버튼 (25% 단위, 25%~400%)
- [ ] **버전 비교**: 같은 씬의 이전 버전과 현재 버전 비교 (향후)

### 2-3. 진행률 100% 완료 인터랙션 `P2` `[완료]`

> 난이도: ●○○ | 참고: Asana 완료 축하 애니메이션

- [x] **씬 완료 애니메이션**: 4단계 모두 체크 시 카드에 컨페티 파티클 효과 (framer-motion)
- [ ] **파트 완료 축하**: 파트 내 모든 씬 완료 시 프로그레스 바에 빛나는 효과 (향후)
- [ ] **에피소드 완료 마일스톤**: 에피소드 전체 완료 시 화면 전체 축하 애니메이션 (향후)
- [ ] **설정에서 토글 가능**: 개인 설정에서 on/off (향후)

---

## Phase 3: 알림 및 협업 시스템

> **목표**: 팀원 간 커뮤니케이션을 앱 안에서 해결. 슬랙과 연동하여 알림 흐름 구축.
> **영향도**: 감독 ↔ 아티스트 간 리뷰 요청/피드백 루프 자동화.

### 3-1. 태그 및 확인요청 버튼 `P3`

> 난이도: ●●○

- [ ] **확인요청 버튼**: 씬 카드에 "확인요청" 버튼 추가
  - 클릭 → 해당 씬의 상태가 "검수 대기"로 변경
  - 담당 감독에게 알림 발송 (앱 내 + 슬랙)
- [ ] **태그 시스템**: 씬에 태그 추가 가능 (`수정필요`, `참고`, `급함` 등)
  - 미리 정의된 태그 + 커스텀 태그
  - 태그별 색상 구분
- [ ] **이름 입력 후 태그 시 알림**: 담당자 변경 또는 태그 시 해당 인원에게 알림

### 3-2. 슬랙 웹훅 연동 `P3`

> 난이도: ●●● | 참고: Kitsu 네이티브 Slack 연동

- [ ] **슬랙 Incoming Webhook 설정**: 설정 뷰에서 웹훅 URL 입력
- [ ] **알림 트리거 설정**:
  - 확인요청 시 → 슬랙 채널에 메시지 발송
  - 태그 시 → 해당 사용자에게 DM 또는 멘션
  - 씬 상태 변경 시 → 채널 알림 (선택 가능)
- [ ] **슬랙 워크플로 연동**: 슬랙 워크플로 빌더와 연계 가능한 페이로드 포맷
- [ ] **알림 메시지 포맷**:

```
📋 BG 확인요청
• 에피소드: EP.03  파트: B
• 씬: a015  담당자: 김하늘
• 요청자: 원동우
• 상태: 완료 → 검수 대기
[앱에서 확인하기]
```

```
UX 참고:
- Kitsu: 사용자별 Slack/Discord 토글 (개인 프로필에서 설정)
- ftrack: @멘션 → 알림 자동 발송 (버전 제작자 자동 포함)
- 핵심: 상태 변경 → 알림이 자동이어야 함. 수동 알림은 잊힘.
```

---

## Phase 4: 뷰 확장 (에피소드 / 캘린더 / 인원별)

> **목표**: 대시보드 외 추가 뷰를 구현하여 다각도 현황 파악 가능하게.
> **영향도**: 감독과 PD가 전체 프로덕션을 한눈에 파악.

### 4-1. 에피소드별 현황 뷰 `P4`

> 난이도: ●●○ | 현재 "구현 예정" placeholder 존재

- [ ] **에피소드 카드 그리드**: 각 에피소드를 카드로 표시
  - 에피소드 번호, 전체 진행률, 파트별 미니 프로그레스 바
  - 클릭 → 해당 에피소드의 씬 목록 뷰로 이동
- [ ] **파트별 매트릭스**: 에피소드 × 파트 테이블 (셀: 진행률 %)
- [ ] **타임라인 바**: 에피소드별 작업 기간 + 완료 예상일

### 4-2. 캘린더 뷰 `P4`

> 난이도: ●●● | 참고: Kitsu 간트 자동생성, ftrack 타임라인 줌

- [ ] **월간/주간 캘린더**: 에피소드 마감일, 마일스톤 표시
- [ ] **간트 차트 (선택)**: 에피소드/파트별 작업 기간 시각화
- [ ] **마감일 경고**: D-3, D-1 시 색상 변경 (노랑 → 빨강)
- [ ] **대시보드 위젯**: 메인 대시보드에 미니 캘린더 위젯 추가

```
UX 참고:
- Kitsu: 예상 작업시간 + 시작일 입력 → 간트 자동 생성, "지연=빨강" 모드
- ftrack: 타임라인 줌 핸들로 날짜 범위 확대/축소
- ShotGrid: 간트 + 리소스 플래닝 뷰 (과할 수 있으므로 간트만 우선)
```

### 4-3. 인원별 태스크 뷰 `P4`

> 난이도: ●●○ | 참고: ftrack My Tasks, Kitsu 퀴타 추적

- [ ] **씬 카드에서 이름 클릭 → 인원별 뷰 전환**
- [ ] **인원별 대시보드**:
  - 해당 담당자의 전체 씬 목록
  - 단계별 진행률 (LO 몇 개 / 완료 몇 개 / 검수 몇 개 / PNG 몇 개)
  - 파트별 분포 차트
- [ ] **생산성 지표 (선택)**: 주간 완료 씬 수 추이

```
UX 참고:
- ftrack: My Tasks가 로그인 후 첫 화면, 칸반 + 활동 피드 + 다가오는 마감
- Kitsu: 인원별 일일 쿼터 (목표 씬 수 대비 실제 완료 수)
```

### 4-4. 메인 대시보드 강화 `P4`

> 난이도: ●●○

- [ ] **담당자별 세부 진행률**: 현재는 씬 완성 시에만 % 반영 → 단계별 세분화
  - 예: 김하늘 — LO: 80%, 완료: 60%, 검수: 40%, PNG: 20% → 종합: 50%
- [ ] **미니 캘린더 위젯**: 대시보드에 이번 주/다음 주 마감일 표시
- [ ] **최근 활동 피드**: "원동우가 EP03_B a015의 LO를 완료" 등 실시간 로그

---

## Phase 5: 커스터마이징 및 확장성

> **목표**: 프로젝트별 / 팀별 맞춤 설정 가능하게. 향후 파이프라인 변경에 유연하게 대응.
> **영향도**: 장기적 유지보수성과 다른 프로젝트 재활용성 확보.

### 5-1. 커스텀 파이프라인 단계 `P5`

> 난이도: ●●● | 참고: ftrack 워크플로 스키마, Kitsu 시맨틱 상태 플래그

현재 `LO → 완료 → 검수 → PNG` 4단계 고정 → 커스텀 단계 추가/제거 가능하게.

- [ ] **단계 설정 UI**: 설정 뷰에서 단계 추가/삭제/순서 변경
  - 각 단계: 이름, 색상, 시맨틱 플래그 (IS_DONE, IS_FEEDBACK_REQUEST 등)
- [ ] **동적 열 생성**: Google Sheets에 새 열 자동 추가 (GAS에서 처리)
- [ ] **기존 데이터 호환**: 새 단계 추가 시 기존 씬은 해당 단계가 `false`로 초기화
- [ ] **타입 시스템 업데이트**: Stage 타입을 고정 유니온 → 동적 배열로 변경

```
데이터 구조 변경:
  현재: Stage = 'lo' | 'done' | 'review' | 'png'  (하드코딩)
  변경: stages: StageConfig[] = [
    { id: 'lo', label: 'LO', color: '#74B9FF', order: 0 },
    { id: 'done', label: '완료', color: '#A29BFE', order: 1 },
    ...커스텀 단계 추가 가능
  ]

UX 참고:
- ftrack: 워크플로 스키마 → 프로젝트별 다른 단계 세트 할당 가능
- Kitsu: IS_DONE, IS_DEFAULT, IS_FEEDBACK_REQUEST 등 시맨틱 플래그로 동작 제어
```

### 5-2. 동기화 최적화 `P5`

> 난이도: ●●○

- [ ] **폴링 주기 설정**: 설정에서 30초 / 1분 / 3분 / 5분 선택 가능
  - 기본값: 1분 (GAS 일일 실행 한도 고려)
  - GAS 무료 한도: ~20,000회/일 → 20명 × 1분 폴링 = ~28,800회/일 (주의 필요)
- [ ] **diff 기반 업데이트**: 전체 재렌더링 대신 변경된 씬만 업데이트
- [ ] **변경 감지 해시**: 서버 응답에 해시 포함 → 변경 없으면 UI 업데이트 스킵
- [ ] **앱 포커스 기반 폴링**: 앱이 포커스 상태일 때만 빈번하게, 백그라운드에서는 느리게

```
GAS 리소스 계산:
  20명 × 60분/시간 × 8시간/일 = 9,600회/일 (1분 주기)
  20명 × 30분/시간 × 8시간/일 = 4,800회/일 (2분 주기)
  → 1분 주기도 GAS 무료 한도(20,000) 이내. 안전.

최적화 전략:
  1. ETag/해시 기반: 변경 없으면 UI 스킵 (네트워크 비용만)
  2. 포커스 기반: 백그라운드 앱은 5분 주기로 전환
  3. 낙관적 업데이트: 이미 적용 완료 (현재 구현)
```

---

## 구현 우선순위 총정리

| 순위 | 항목 | 페이즈 | 난이도 | 비고 |
|------|------|--------|--------|------|
| 1 | 버전 표기 시스템 | P1 | ●○○ | ✅ 완료 |
| 2 | 씬 목록 정렬/필터 개선 | P1 | ●●○ | ✅ 완료 |
| 3 | 씬번호 입력 개선 | P1 | ●●○ | ✅ 완료 |
| 4 | 레이아웃별 씬 그룹핑 | P1 | ●●● | ✅ 완료 |
| 5 | 이미지 업로드/미리보기 | P2 | ●●● | ✅ 완료 |
| 6 | 진행률 100% 애니메이션 | P2 | ●○○ | ✅ 완료 |
| 7 | 이미지 비교 뷰 | P2 | ●●○ | ✅ 완료 |
| 8 | 태그/확인요청 버튼 | P3 | ●●○ | 협업 핵심 |
| 9 | 슬랙 웹훅 연동 | P3 | ●●● | 알림 자동화 |
| 10 | 에피소드별 현황 뷰 | P4 | ●●○ | PD/감독 뷰 |
| 11 | 인원별 태스크 뷰 | P4 | ●●○ | 개인 현황 |
| 12 | 메인 대시보드 강화 | P4 | ●●○ | 세부 진행률 |
| 13 | 캘린더/간트 뷰 | P4 | ●●● | 일정 관리 |
| 14 | 커스텀 파이프라인 단계 | P5 | ●●● | 확장성 확보 |
| 15 | 동기화 최적화 | P5 | ●●○ | 성능/안정성 |

---

## 아키텍처 고려사항

### 코드 유지보수 원칙

1. **서비스 레이어 분리**: 모든 데이터 조작은 `services/` 통해서만 (뷰에서 직접 API 호출 금지)
2. **낙관적 업데이트 패턴 통일**: 모든 CRUD는 `store.xxxOptimistic()` → 백그라운드 동기화
3. **타입 안전성**: 새 필드/단계 추가 시 `types/index.ts`에서 시작하여 컴파일 에러로 가이드
4. **컴포넌트 재사용**: 씬 카드, 프로그레스 바, 필터 칩 등 `components/ui/`에 분리
5. **테스트 모드 동등성**: 모든 기능은 테스트 모드에서도 100% 동작해야 함

### 파일 구조 확장 계획

```
src/
├── components/
│   ├── ui/           ← 공통 UI (Button, Modal, Tag, ProgressBar...)
│   ├── scenes/       ← 씬 관련 (SceneCard, SceneForm, ImagePreview...)
│   ├── layout/       ← 레이아웃 (MainLayout, Sidebar, Header)
│   └── widgets/      ← 대시보드 위젯
├── views/
│   ├── Dashboard.tsx
│   ├── ScenesView.tsx
│   ├── EpisodeView.tsx     ← P4 신규
│   ├── CalendarView.tsx    ← P4 신규
│   ├── AssigneeView.tsx    ← P4 신규
│   └── SettingsView.tsx
├── services/
│   ├── sheetsService.ts      ← GAS 연동
│   ├── testSheetService.ts   ← 테스트 모드
│   ├── imageService.ts       ← P2 이미지 업로드/캐싱
│   ├── slackService.ts       ← P3 슬랙 웹훅
│   └── settingsService.ts
├── stores/
│   ├── useDataStore.ts       ← 에피소드/씬 데이터 + 낙관적 업데이트
│   ├── useAppStore.ts        ← UI 상태 (뷰, 필터, 연결상태)
│   └── useNotificationStore.ts  ← P3 알림 상태
├── types/
│   └── index.ts              ← 모든 타입 정의 (Stage, Scene, Episode...)
└── utils/
    ├── calcStats.ts
    ├── cn.ts
    └── formatters.ts         ← 날짜, 숫자 포맷 유틸
```

---

## 참고한 도구 및 UX 패턴

| 도구 | 주요 참고 패턴 |
|------|--------------|
| **ShotGrid** (Autodesk) | 리스트/썸네일/디테일 3단 뷰 토글, 캔버스 대시보드, 간트 리소스 플래닝 |
| **ftrack** | 멀티레벨 그룹핑, 오버레이 이미지 비교, 칸반 태스크 보드, 워크플로 스키마 |
| **Kitsu** (CGWire) | 상태 매트릭스 뷰, 클립보드 붙여넣기, 네이티브 Slack 연동, 간트 자동생성, 쿼터 추적 |
| **Asana** | 선택적 완료 축하 애니메이션 (비차단, 토글 가능) |
| **Linear** | 미니멀 UI, 키보드 단축키 중심, 빠른 상태 전환 |

---

*이 문서는 새 기능 기획/구현 시 매번 갱신하며, CLAUDE.md에서 참조합니다.*
